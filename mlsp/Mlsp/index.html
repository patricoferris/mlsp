<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Mlsp (mlsp.Mlsp)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.4"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../index.html">mlsp</a> &#x00BB; Mlsp</nav><header class="odoc-preamble"><h1>Module <code><span>Mlsp</span></code></h1></header><nav class="odoc-toc"><ul><li><a href="#mlsp">Mlsp</a><ul><li><a href="#routes">Routes</a></li><li><a href="#running-the-server">Running the server</a></li><li><a href="#markup">Markup</a></li><li><a href="#helpers">Helpers</a></li></ul></li></ul></nav><div class="odoc-content"><h2 id="mlsp"><a href="#mlsp" class="anchor"></a>Mlsp</h2><p>A small (micro) LSP toolkit for building servers in OCaml.</p><div class="odoc-spec"><div class="spec module anchored" id="module-T"><a href="#module-T" class="anchor"></a><code><span><span class="keyword">module</span> T</span><span> = <span class="xref-unresolved">Lsp</span>.Types</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-request"><a href="#type-request" class="anchor"></a><code><span><span class="keyword">type</span> request</span></code></div><div class="spec-doc"><p>A client request</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-method_"><a href="#val-method_" class="anchor"></a><code><span><span class="keyword">val</span> method_ : <span><a href="#type-request">request</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>method_ req</code> returns the raw method string for the client request</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-id"><a href="#val-id" class="anchor"></a><code><span><span class="keyword">val</span> id : <span><a href="#type-request">request</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Jsonrpc</span>.Id.t</span></code></div><div class="spec-doc"><p>The unique ID for the client request</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-response"><a href="#type-response" class="anchor"></a><code><span><span class="keyword">type</span> response</span></code></div><div class="spec-doc"><p>A server response</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-handler"><a href="#type-handler" class="anchor"></a><code><span><span class="keyword">type</span> handler</span><span> = <span><a href="#type-request">request</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-response">response</a> option</span></span></code></div><div class="spec-doc"><p>A handler takes a request from an LSP client and, optionally, returns a response.</p><p>If <code>None</code> is returned then we treat the request as ignored.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-middleware"><a href="#type-middleware" class="anchor"></a><code><span><span class="keyword">type</span> middleware</span><span> = <span><a href="#type-handler">handler</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-handler">handler</a></span></code></div><div class="spec-doc"><p>Middleware sits inbetween handlers, usually doing some side-effecting action.</p><p>See <a href="#val-logger"><code>logger</code></a> for an example middleware.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-logger"><a href="#val-logger" class="anchor"></a><code><span><span class="keyword">val</span> logger : <a href="#type-middleware">middleware</a></span></code></div><div class="spec-doc"><p>The logger will log all incoming requests</p></div></div><h3 id="routes"><a href="#routes" class="anchor"></a>Routes</h3><p>Routes are the main way you can customise your LSP server. They allow you to define what your server does in response to specific incoming client requests.</p><p>Your server <b>must</b> implement the <code>initialize</code> route in order for you server to complete a handshake with a client. The <a href="#val-capabilities"><code>capabilities</code></a> function may be of use.</p><div class="odoc-spec"><div class="spec type anchored" id="type-route"><a href="#type-route" class="anchor"></a><code><span><span class="keyword">type</span> route</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-routes"><a href="#val-routes" class="anchor"></a><code><span><span class="keyword">val</span> routes : <span><span><a href="#type-route">route</a> list</span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-handler">handler</a></span></code></div><div class="spec-doc"><p>Make a handler from a list of routes. The routes will be tried in the order they are given.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-hover"><a href="#val-hover" class="anchor"></a><code><span><span class="keyword">val</span> hover : <span><span>(<span><span class="xref-unresolved">T</span>.HoverParams.t <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">T</span>.Hover.t option</span>)</span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-route">route</a></span></code></div><div class="spec-doc"><p>Creates a hover route.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-code_action"><a href="#val-code_action" class="anchor"></a><code><span><span class="keyword">val</span> code_action : <span><span>(<span><span class="xref-unresolved">T</span>.CodeActionParams.t <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">T</span>.CodeActionResult.t)</span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-route">route</a></span></code></div><div class="spec-doc"><p>Creates a code action route.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-codelens"><a href="#val-codelens" class="anchor"></a><code><span><span class="keyword">val</span> codelens : <span><span>(<span><span class="xref-unresolved">T</span>.CodeLensParams.t <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">T</span>.CodeLens.t list</span>)</span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-route">route</a></span></code></div><div class="spec-doc"><p>Creates a codelens route.</p></div></div><h3 id="running-the-server"><a href="#running-the-server" class="anchor"></a>Running the server</h3><div class="odoc-spec"><div class="spec value anchored" id="val-run"><a href="#val-run" class="anchor"></a><code><span><span class="keyword">val</span> run : 
  <span><span class="optlabel">?on_notification</span>:<span>(<span><span class="xref-unresolved">Lsp</span>.Client_notification.t <span class="arrow">&#45;&gt;</span></span> unit)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">init</span>:<span>(<span><span class="xref-unresolved">T</span>.InitializeParams.t <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">T</span>.InitializeResult.t)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Bytesrw</span>.Bytes.Reader.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Bytesrw</span>.Bytes.Writer.t <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-handler">handler</a> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p>Run the server using a <code>Bytes.Reader.t</code> and a <code>Bytes.Writer.t</code>.</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">init</span> <p>A special handler that is required for any server. Mostly <code>init</code> will let the client know what capabilities the server can handle.</p></li></ul></div></div><h3 id="markup"><a href="#markup" class="anchor"></a>Markup</h3><div class="odoc-spec"><div class="spec module anchored" id="module-Markup"><a href="#module-Markup" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Markup/index.html">Markup</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><h3 id="helpers"><a href="#helpers" class="anchor"></a>Helpers</h3><div class="odoc-spec"><div class="spec value anchored" id="val-capabilities"><a href="#val-capabilities" class="anchor"></a><code><span><span class="keyword">val</span> capabilities : 
  <span><span class="optlabel">?hover</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?call_hierarchy</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?code_action</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?codelens</span>:<span class="xref-unresolved">T</span>.CodeLensOptions.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?color</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?completion</span>:<span class="xref-unresolved">T</span>.CompletionOptions.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?declaration</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?definition</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?diagnostic</span>:
    <span>[ <span>`DiagnosticOptions of <span class="xref-unresolved">T</span>.DiagnosticOptions.t</span>
    <span><span>| `DiagnosticRegistrationOptions</span> of <span class="xref-unresolved">T</span>.DiagnosticRegistrationOptions.t</span> ]</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?document_formatting</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?document_highlight</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?document_link</span>:<span class="xref-unresolved">T</span>.DocumentLinkOptions.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?document_on_type_formatting</span>:<span class="xref-unresolved">T</span>.DocumentOnTypeFormattingOptions.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?document_range_formatting</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?document_symbol</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?execute_command</span>:<span class="xref-unresolved">T</span>.ExecuteCommandOptions.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?experimental</span>:<span class="xref-unresolved">Yojson</span>.Safe.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?folding_range</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?implementation</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?inlay_hint</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?inline_completion</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?inline_value</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?linked_editing_range</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?moniker</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?notebook_document_sync</span>:
    <span>[ <span>`NotebookDocumentSyncOptions of unit</span>
    <span><span>| `NotebookDocumentSyncRegistrationOptions</span> of unit</span> ]</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?position_encoding</span>:<span class="xref-unresolved">T</span>.PositionEncodingKind.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?references</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?rename</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?selection_range</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?semantic_tokens</span>:
    <span>[ <span>`SemanticTokensOptions of <span class="xref-unresolved">T</span>.SemanticTokensOptions.t</span>
    <span><span>| `SemanticTokensRegistrationOptions</span> of
      <span class="xref-unresolved">T</span>.SemanticTokensRegistrationOptions.t</span> ]</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?signature_help</span>:<span class="xref-unresolved">T</span>.SignatureHelpOptions.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?text_document</span>:<span class="xref-unresolved">T</span>.ServerCapabilities.textDocument <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?text_document_sync</span>:
    <span>[ <span>`TextDocumentSyncKind of <span class="xref-unresolved">T</span>.TextDocumentSyncKind.t</span>
    <span><span>| `TextDocumentSyncOptions</span> of <span class="xref-unresolved">T</span>.TextDocumentSyncOptions.t</span> ]</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?type_definition</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?type_hierarchy</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?workspace</span>:<span class="xref-unresolved">T</span>.ServerCapabilities.workspace <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?workspace_symbol</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span class="xref-unresolved">T</span>.ServerCapabilities.t</span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Private"><a href="#module-Private" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Private/index.html">Private</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div></div></body></html>
